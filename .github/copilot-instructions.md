mkdir -p .github

cat > .github/copilot-instructions.md <<'EOF'

# Copilot Instructions â€” GPT Assistant Scheduler

> **Purpose:** Guide AI agents to efficiently develop, debug, and extend this TypeScript monorepo (Next.js, Express, Zod, pnpm workspaces) for the Scheduler project.

## Architecture Overview

- **Monorepo structure** (pnpm workspaces):
  - `apps/web`: Next.js 15+ UI (App Router, server/client components, custom session logic)
  - `services/api`: Express API (task orchestration, onboarding, demo seed data)
  - `packages/types`: Shared Zod schemas and TypeScript types
- **Data contracts:** All cross-service types/schemas live in `packages/types` and are imported with explicit `.js` extensions for NodeNext ESM compatibility.
- **Build & dev:** Use pnpm scripts and VS Code tasks. All builds must succeed (`pnpm build`). Dev servers: `pnpm dev:web` (port 3000), `pnpm dev:api` (port 3333 or 3001).

## Key Patterns & Conventions

- **TypeScript ESM:** All imports between packages use explicit `.js` extensions (NodeNext). Example:
  ```ts
  import { Organization } from "../../../packages/types/src/onboarding.js";
  ```
- **Session management:** See `apps/web/lib/session.ts` for custom cookie/session logic. Use only synchronous `cookies()` in server components.
- **Onboarding flow:** Client UI logic is separated into `Client.tsx` files; server pages import these as children.
- **API endpoints:** All Express routes in `services/api/src/index.ts`. Demo data/seed logic in `services/api/src/seed.ts`.
- **Health checks:** API exposes `/health`, `/seed-status`, and `/hierarchy/echo` endpoints for monitoring and integration tests.

## Developer Workflows

- **Install:** `pnpm install`
- **Build:** `pnpm build` (runs types, api, web builds in order)
- **Dev:** Use VS Code tasks (`dev:web`, `dev:api`) or run:
  ```bash
  pnpm --filter @apps/web dev
  pnpm --filter @services/api dev
  ```
- **Lint/typecheck:** `pnpm lint`, `pnpm typecheck`
- **Testing:** (Add tests in `/tests` or per package; not present by default)
- **Docs:** API docs in `/docs/API` (generated by TypeDoc)

## Troubleshooting

- **Port conflicts:** If `EADDRINUSE` on 3000/3001, kill stale Next.js or API processes before restarting dev tasks.
- **Next.js config:** Use top-level `outputFileTracingRoot` in `next.config.js` for monorepo compatibility.
- **ESM import errors:** Always use explicit `.js` extensions for cross-package imports in NodeNext projects.

## Examples

- **Add a new Zod schema:** Edit `packages/types/src/onboarding.ts`, then rebuild types and dependent packages.
- **Expose a new API route:** Add to `services/api/src/index.ts`, import types from `packages/types` as above.

---

**Feedback needed:**  
- Are there any custom scripts, workflows, or integration points not covered here?
- Should any deprecated patterns or files be called out for migration?

Let me know if you want to clarify or expand any section!
